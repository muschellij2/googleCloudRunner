<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Serverless batched R scripts via Cloud Build • googleCloudRunner</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Serverless batched R scripts via Cloud Build">
<meta property="og:description" content="googleCloudRunner">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-47480439-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-47480439-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">googleCloudRunner</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-wrench"></span>
     
    Setup
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/setup.html">R Setup</a>
    </li>
    <li>
      <a href="../articles/setup-gcp.html">GCP Setup</a>
    </li>
    <li>
      <a href="../articles/git.html">Git Setup</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/cloudbuild.html">
    <span class="fa fa-shapes"></span>
     
    Cloud Build
  </a>
</li>
<li>
  <a href="../articles/cloudrun.html">
    <span class="fa fa-running"></span>
     
    Cloud Run
  </a>
</li>
<li>
  <a href="../articles/cloudscheduler.html">
    <span class="fa fa-clock"></span>
     
    Cloud Scheduler
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-hands-helping"></span>
     
    Use Cases
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/usecase-r-api-microservices.html">R API Microservices</a>
    </li>
    <li>
      <a href="../articles/usecase-shiny-cloudrun.html">Deploy Shiny on Cloud Run</a>
    </li>
    <li>
      <a href="../articles/usecase-shiny-kubernetes.html">Deploy Shiny on Kubernetes</a>
    </li>
    <li>
      <a href="../articles/usecase-package-docker-build.html">R Package Tools: Auto Docker images</a>
    </li>
    <li>
      <a href="../articles/usecase-testthat-coverage.html">R Package Tools: Testthat coverage</a>
    </li>
    <li>
      <a href="../articles/usecase-deploy-pkgdown-website.html">R Package Tools: Pkgdown websites</a>
    </li>
    <li>
      <a href="../articles/usecase-scheduled-r-builds.html">Scheduled R scripts in the Cloud</a>
    </li>
    <li>
      <a href="../articles/usecase-r-results-github.html">Save R output to GitHub</a>
    </li>
    <li>
      <a href="../articles/usecase-polygot-ga-imports-to-bigquery.html">Integrating R with other languages</a>
    </li>
    <li>
      <a href="../articles/usecase-r-event-driven-pubsub.html">Event-triggered R scripts with pub/sub</a>
    </li>
    <li>
      <a href="../articles/usecase-slackbot-google-analytics.html">Create a Slackbot downloading Google Analytics</a>
    </li>
    <li>
      <a href="../articles/usecase-scheduled-google-analytics.html">Schedule Google Analytics User Deletion API</a>
    </li>
    <li>
      <a href="../articles/usecase-rmarkdown-cloudrun.html">On-demand parameterised R Markdown reports</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-question"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MarkEdmondson1234/googleCloudRunner/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Serverless batched R scripts via Cloud
Build</h1>
            
            <h4 data-toc-skip class="date">2022-03-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MarkEdmondson1234/googleCloudRunner/blob/HEAD/vignettes/cloudbuild.Rmd" class="external-link"><code>vignettes/cloudbuild.Rmd</code></a></small>
      <div class="hidden name"><code>cloudbuild.Rmd</code></div>

    </div>

    
    
<p>Cloud Build uses <a href="https://www.docker.com/resources/what-container" class="external-link">Docker
containers</a> to run everything. This means it can run almost any
language/program or application including R. Having an easy way to
create and trigger these builds from R means R can serve as a UI or
gateway to any other program e.g. R can trigger a Cloud Build using
<code>gcloud</code> to deploy Cloud Run applications.</p>
<p>The first 120 mins per day are free. <a href="https://cloud.google.com/cloud-build/pricing" class="external-link">See here for more
priceinfo.</a></p>
<p>If you want to run scripts that can be triggered one time, batch
style, and set them up to trigger on GitHub events or pub/sub, or
schedule them using Cloud Scheduler then Cloud Build is suited to your
use case.</p>
<p>If you would also like to have your R code react in real-time to
events such as HTTP events, such as a website or API endpoint, consider
<a href="https://code.markedmondson.me/googleCloudRunner/articles/cloudrun.html">Cloud
Run</a>.</p>
<p>PubSub events can also trigger builds via Build Triggers which is
good for long-running tasks in reaction to events such as a Cloud
Storage file being uploaded, various events around Google Cloud such as
billing alerts and via custom metrics set up in Cloud Logging for
practically any logged event on Google Cloud.</p>
<p>An overview of the various functions and how they combine with each
other and later functions is shown in this diagram:</p>
<p><img src="build_plot.png"></p>
<div class="section level2">
<h2 id="the-cloudbuild-yaml-format">The cloudbuild.yaml format<a class="anchor" aria-label="anchor" href="#the-cloudbuild-yaml-format"></a>
</h2>
<p>Cloud Build is centered around the <a href="https://cloud.google.com/cloud-build/docs/build-config" class="external-link">cloudbuild.yaml
format</a> - you can use existing cloudbuild.yaml files or create your
own in R using the cloudbuild.yaml helper functions.</p>
<p>An example cloudbuild.yaml is shown below - this outputs the versions
of docker and echos “Hello Cloud Build” and calls an R function:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">'gcr.io/cloud-builders/docker'</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">id</span><span class="kw">:</span><span class="at"> Docker Version</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"version"</span><span class="kw">]</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">'alpine'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">id</span><span class="kw">:</span><span class="at">  Hello Cloud Build</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"echo"</span><span class="kw">,</span><span class="at"> </span><span class="st">"Hello Cloud Build"</span><span class="kw">]</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">'rocker/r-base'</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">id</span><span class="kw">:</span><span class="at"> Hello R</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"R"</span><span class="kw">,</span><span class="at"> </span><span class="st">"-e"</span><span class="kw">,</span><span class="at"> </span><span class="st">"paste0('1 + 1 = ', 1+1)"</span><span class="kw">]</span></span></code></pre></div>
<p>This cloudbuild.yaml file can be built directly via the
<code><a href="../reference/cr_build.html">cr_build()</a></code> function. The build will by default trigger a
website URL to open with the build logs.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build.html">cr_build</a></span><span class="op">(</span><span class="st">"cloudbuild.yaml"</span><span class="op">)</span></code></pre></div>
<p>Or you can choose to wait in R for the build to finish, like
below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build.html">cr_build</a></span><span class="op">(</span><span class="st">"cloudbuild.yaml"</span>, launch_browser <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_wait.html">cr_build_wait</a></span><span class="op">(</span><span class="va">b2</span><span class="op">)</span>
<span class="co"># Waiting for build to finish:</span>
<span class="co">#  |===||</span>
<span class="co"># Build finished</span>
<span class="co"># ==CloudBuildObject==</span>
<span class="co"># buildId:  c673143a-794d-4c69-8ad4-e777d068c066 </span>
<span class="co"># status:  SUCCESS </span>
<span class="co"># logUrl:  https://console.cloud.google.com/gcr/builds/c673143a-794d-4c69-8ad4-e777d068c066?project=1080525199262 </span>
<span class="co"># ...</span></code></pre></div>
<p>You can export an existing build into a cloudbuild.yaml file, for
instance to run in another project not using R.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cr_build_write.html">cr_build_write</a></span><span class="op">(</span><span class="va">b3</span>, file <span class="op">=</span> <span class="st">"cloudbuild.yml"</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="constructing-cloud-build-objects">Constructing Cloud Build objects<a class="anchor" aria-label="anchor" href="#constructing-cloud-build-objects"></a>
</h3>
<p>There are several layers to creating Cloud Build objects in R:</p>
<ul>
<li>
<code><a href="../reference/cr_build.html">cr_build()</a></code> triggers the API with Cloud Build objects
and cloudbuild.yaml files</li>
<li>
<code><a href="../reference/cr_build_yaml.html">cr_build_yaml()</a></code> lets you create the Cloud Build objects
in R and can write to .yaml files.</li>
<li>
<code><a href="../reference/cr_build_make.html">cr_build_make()</a></code> creates Cloud Build R objects directly
from .yaml files</li>
<li>
<code><a href="../reference/cr_buildstep.html">cr_buildstep()</a></code> lets you create specific steps within
the Cloud Build objects. There are helper template files with common
tasks such as <code><a href="../reference/cr_buildstep_r.html">cr_buildstep_r()</a></code>
</li>
</ul>
<p>For common use cases the <code>cr_deploy_*</code> functions use the
above functions with some sensible defaults to quickly run use cases for
you:</p>
<ul>
<li>
<code><a href="../reference/cr_deploy_docker.html">cr_deploy_docker()</a></code> - builds from a Dockerfile then
pushes the Docker image to Google Container Registry</li>
<li>
<code><a href="../reference/cr_deploy_docker_trigger.html">cr_deploy_docker_trigger()</a></code> - as above, plus creating a
build trigger so the build will run upon each git commit - see the <a href="https://code.markedmondson.me/googleCloudRunner/articles/usecase-package-docker-build.html">Docker
image use case</a> for both.</li>
<li>
<code><a href="../reference/cr_deploy_packagetests.html">cr_deploy_packagetests()</a></code> - create a build that will run
R package unit tests and a build trigger to run them upon each commit -
see the <a href="https://code.markedmondson.me/googleCloudRunner/articles/usecase-testthat-coverage.html">package
tests and code coverage use case</a>
</li>
<li>
<code><a href="../reference/cr_deploy_pkgdown.html">cr_deploy_pkgdown()</a></code> - create a build that will deploy
an R package website and a build trigger to create it upon each commit -
see the <a href="https://code.markedmondson.me/googleCloudRunner/articles/usecase-deploy-pkgdown-website.html">pkgdown
website use case</a>.</li>
<li>
<code><a href="../reference/cr_deploy_run_website.html">cr_deploy_run_website()</a></code> - take HTML you have in a
folder (perhaps created from an RMarkdown file) and deploy it to a nginx
website on Cloud Run</li>
<li>
<code><a href="../reference/cr_deploy_r.html">cr_deploy_r()</a></code> - take the R script you supply and run it
within a Cloud Build. Optionally also schedule that R script - see the
<a href="https://code.markedmondson.me/googleCloudRunner/articles/usecase-scheduled-r-builds.html">R
code on a schedule use case</a>.</li>
<li>
<code><a href="../reference/cr_deploy_run.html">cr_deploy_run()</a></code> - takes a local folder, builds the
Docker image suitable for Cloud run and deploys to Cloud Run. Variants
include <code><a href="../reference/cr_deploy_run.html">cr_deploy_plumber()</a></code> to R plumber APIs and
<code><a href="../reference/cr_deploy_run.html">cr_deploy_html()</a></code> for nginx websites. See the <a href="https://code.markedmondson.me/googleCloudRunner/articles/usecase-r-api-microservices.html">R
micro-services</a>, <a href="https://code.markedmondson.me/googleCloudRunner/articles/usecase-r-event-driven-pubsub.html">trigger
R functions from pub/sub</a> and <a href="https://code.markedmondson.me/googleCloudRunner/articles/usecase-slackbot-google-analytics.html">creating
a Slackbot</a> use cases</li>
</ul>
<p>Some of the above are also available in an RStudio gadget.</p>
<p>The deploy functions call the underlying cloud build functions, so if
they don’t suit you can also customise by using those. An overview on
what the deploy functions use is below:</p>
<p><img src="deploy_plot.png"></p>
</div>
<div class="section level3">
<h3 id="docker-images-to-use-in-cloud-build">Docker images to use in Cloud Build<a class="anchor" aria-label="anchor" href="#docker-images-to-use-in-cloud-build"></a>
</h3>
<p>Any utility that has a Docker image can be used within Cloud Build
steps.</p>
<p>Official Google images for the <code>gcloud</code>, <code>bq</code>
and <code>gsutil</code> are here: <a href="https://github.com/GoogleCloudPlatform/cloud-sdk-docker" class="external-link uri">https://github.com/GoogleCloudPlatform/cloud-sdk-docker</a></p>
<p>Some <a href="https://github.com/GoogleCloudPlatform/cloud-builders-community" class="external-link">community
contributed Cloud Build images are listed here</a>, including <a href="https://github.com/GoogleCloudPlatform/cloud-builders-community/tree/master/hugo" class="external-link">hugo</a>,
<a href="https://github.com/GoogleCloudPlatform/cloud-builders-community/tree/master/make" class="external-link">make</a>,
and <a href="https://github.com/GoogleCloudPlatform/cloud-builders-community/tree/master/tar" class="external-link">tar</a>,
or you can configure your own Dockerfile and build what image you need
yourself, perhaps by using a previous Cloud Build and
<code><a href="../reference/cr_deploy_docker.html">cr_deploy_docker()</a></code></p>
</div>
</div>
<div class="section level2">
<h2 id="cloud-build-source">Cloud Build source<a class="anchor" aria-label="anchor" href="#cloud-build-source"></a>
</h2>
<p>Cloud Builds sometimes need code or data to work on to be useful.</p>
<p>All cloudbuilds are launched in a serverless environment with a
default directory <code>/workspace/</code>. The Source is copied into
this workspace before the build steps execute, so steps can share state
and files. Cloud Build sources are specified by the <code>source</code>
argument.</p>
<p>A source can be a <a href="https://cloud.google.com/source-repositories/" class="external-link">Cloud Source
Repository</a> (perhaps mirrored from GitHub) or a <a href="https://cloud.google.com/storage/" class="external-link">Cloud Storage</a> bucket
containing the code/data you want to operate on. An example of
specifying both is below:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gcs_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_source.html">cr_build_source</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/StorageSource.html">StorageSource</a></span><span class="op">(</span><span class="st">"gs://my-bucket"</span>, <span class="st">"my_code.tar.gz"</span><span class="op">)</span><span class="op">)</span>
  
<span class="va">repo_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_source.html">cr_build_source</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/RepoSource.html">RepoSource</a></span><span class="op">(</span><span class="st">"github_markedmondson1234_googlecloudrunner"</span>,
             branchName<span class="op">=</span><span class="st">"master"</span><span class="op">)</span><span class="op">)</span>

<span class="va">build1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build.html">cr_build</a></span><span class="op">(</span><span class="st">"cloudbuild.yaml"</span>, source <span class="op">=</span> <span class="va">gcs_source</span><span class="op">)</span>
<span class="va">build2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build.html">cr_build</a></span><span class="op">(</span><span class="st">"cloudbuild.yaml"</span>, source <span class="op">=</span> <span class="va">repo_source</span><span class="op">)</span></code></pre></div>
<p><code><a href="../reference/cr_build_upload_gcs.html">cr_build_upload_gcs()</a></code> is a helper function for
automating creation of a Google Cloud Storage source - this uses <a href="http://code.markedmondson.me/googleCloudStorageR/" class="external-link"><code>googleCloudStorageR</code></a>
to tar and upload your source code locally to your bucket, making it
available to your build.</p>
<p>This returns a <code>Source</code> object that can be used in build
functions:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">storage</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_upload_gcs.html">cr_build_upload_gcs</a></span><span class="op">(</span><span class="st">"my_folder"</span><span class="op">)</span>
<span class="fu"><a href="../reference/cr_build.html">cr_build</a></span><span class="op">(</span><span class="va">my_yaml</span>, source <span class="op">=</span> <span class="va">storage</span><span class="op">)</span></code></pre></div>
<p>By default this will place your local folder’s contents in the
<code>/workspace/deploy/</code> folder. For buildsteps to access those
files you may want to add <code>dir="deploy"</code> to them so they will
have their working directory start from there, but to be more consistent
with Build triggers (that always use sources in the root
<code>/workspace</code> directory) a helpful build step can move that
deploy folder into root - see <code><a href="../reference/cr_build_upload_gcs.html">cr_buildstep_source_move()</a></code>
which is intended to be the first buildstep of a build in those
situations you want to move deploy folders.</p>
</div>
<div class="section level2">
<h2 id="cloud-build-default-substitutions">Cloud Build default substitutions<a class="anchor" aria-label="anchor" href="#cloud-build-default-substitutions"></a>
</h2>
<p>Cloud Builds can use reserved default substitutions to help with
deployments in a continuous development situation. For instance, files
can be named according to the Git branch they are committed from. These
are <a href="https://cloud.google.com/build/docs/configuring-builds/substitute-variable-values" class="external-link">listed
in Google docs here</a> and reproduced below:</p>
<ul>
<li>$PROJECT_ID: the project ID of the build.</li>
<li>$BUILD_ID: the autogenerated ID of the build.</li>
<li>$REPO_NAME: the source repository name specified by RepoSource.</li>
<li>$LOCATION: the region of your build</li>
<li>$BRANCH_NAME: the branch name specified by RepoSource.</li>
<li>$TAG_NAME: the tag name specified by RepoSource.</li>
<li>$REVISION_ID or $COMMIT_SHA: the commit SHA specified by RepoSource
or resolved from the specified branch or tag.</li>
<li>$SHORT_SHA: first 7 characters of $REVISION_ID or $COMMIT_SHA.</li>
<li>$TRIGGER_BUILD_CONFIG_PATH: path to the build config file, by
default /cloudbuild.yaml</li>
</ul>
<p>There are also some GitHub specific substitutions, used mostly in
Build Triggers we detail later on.</p>
<ul>
<li>$_HEAD_BRANCH : head branch of the pull request</li>
<li>$_BASE_BRANCH : base branch of the pull request</li>
<li>$_HEAD_REPO_URL : url of the head repo of the pull request</li>
<li>$_PR_NUMBER : number of the pull request</li>
</ul>
<p>Custom macros can also be configured, starting with _$
e.g. $_MY_CUSTOM_MACRO - see the <a href="https://cloud.google.com/build/docs/configuring-builds/substitute-variable-values" class="external-link">Google
help files</a> on how to handle those.</p>
</div>
<div class="section level2">
<h2 id="creating-cloudbuild-yml-build-steps">Creating cloudbuild.yml build steps<a class="anchor" aria-label="anchor" href="#creating-cloudbuild-yml-build-steps"></a>
</h2>
<p>Instead of using separate <code>cloudbuild.yml</code> files, you can
also choose to make your own cloudbuild.yaml files in R via
<code><a href="../reference/cr_build_yaml.html">cr_build_yaml()</a></code> and <code><a href="../reference/cr_buildstep.html">cr_buildstep()</a></code></p>
<p>Lets say you don’t want to write a cloudbuild.yaml file manually -
instead you can create all the features of the yaml files in R. Refer to
the <a href="https://cloud.google.com/cloud-build/docs/build-config" class="external-link">cloudbuild.yml
config spec</a> on what is expected in the files or functions.</p>
<p>An example below recreates a simple cloudbuild.yml file. If you print
it to console it will output what the build would look like if it was in
a yaml file:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cr_build_yaml.html">cr_build_yaml</a></span><span class="op">(</span>steps <span class="op">=</span> <span class="fu"><a href="../reference/cr_buildstep.html">cr_buildstep</a></span><span class="op">(</span> <span class="st">"gcloud"</span>,<span class="st">"version"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#==cloudRunnerYaml==</span>
<span class="co">#steps:</span>
<span class="co">#- name: gcr.io/cloud-builders/gcloud</span>
<span class="co">#  args: version</span></code></pre></div>
<p>You can write back out into your own cloudbuild.yml</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_yaml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_yaml.html">cr_build_yaml</a></span><span class="op">(</span>steps <span class="op">=</span> <span class="fu"><a href="../reference/cr_buildstep.html">cr_buildstep</a></span><span class="op">(</span> <span class="st">"gcloud"</span>,<span class="st">"version"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/cr_build_write.html">cr_build_write</a></span><span class="op">(</span><span class="va">my_yaml</span>, file <span class="op">=</span> <span class="st">"cloudbuild.yaml"</span><span class="op">)</span></code></pre></div>
<p>And also edit or extract steps from existing cloudbuild.yml files via
<code><a href="../reference/cr_buildstep_edit.html">cr_buildstep_edit()</a></code> and
<code><a href="../reference/cr_buildstep_extract.html">cr_buildstep_extract()</a></code>.</p>
<p>This allows you to programmatically create cloudbuild yaml files for
other languages and triggers. See more at this article on <a href="https://cloud.google.com/cloud-build/docs/create-custom-build-steps" class="external-link">creating
custom build steps with your own Docker images</a>.</p>
</div>
<div class="section level2">
<h2 id="pre-made-build-step-templates">Pre-made Build Step templates<a class="anchor" aria-label="anchor" href="#pre-made-build-step-templates"></a>
</h2>
<p>Using the above build step editing functions, some helpful build
steps you can use in your own cloudbuild steps have been included in the
package.</p>
<ul>
<li>
<code><a href="../reference/cr_buildstep_gcloud.html">cr_buildstep_gcloud()</a></code> - an optimised docker for
<code>gcloud</code>, <code>bq</code>, <code>gsutil</code> or
<code>kubectl</code> commands</li>
<li>
<code><a href="../reference/cr_buildstep_bash.html">cr_buildstep_bash()</a></code> - for including bash scripts</li>
<li>
<code><a href="../reference/cr_buildstep_docker.html">cr_buildstep_docker()</a></code> - for building and pushing Docker
images</li>
<li>
<code><a href="../reference/cr_buildstep_secret.html">cr_buildstep_secret()</a></code> - storing secrets in the cloud
and decrypting them</li>
<li>
<code><a href="../reference/cr_buildstep_decrypt.html">cr_buildstep_decrypt()</a></code> - for using Google Key
management store to decrypt auth files</li>
<li>
<code><a href="../reference/cr_buildstep_git.html">cr_buildstep_git()</a></code> - for setting up and running git
commands</li>
<li>
<code><a href="../reference/cr_buildstep_mailgun.html">cr_buildstep_mailgun()</a></code> - send an email with
Mailgun.org</li>
<li>
<code><a href="../reference/cr_buildstep_nginx_setup.html">cr_buildstep_nginx_setup()</a></code> - setup hosting HTML files
with nginx on Cloud Run</li>
<li>
<code><a href="../reference/cr_buildstep_pkgdown.html">cr_buildstep_pkgdown()</a></code> - for setting up pkgdown
documentation of an R package</li>
<li>
<code><a href="../reference/cr_buildstep_r.html">cr_buildstep_r()</a></code> - for running R code</li>
<li>
<code><a href="../reference/cr_buildstep_slack.html">cr_buildstep_slack()</a></code> - send a Slack webhook
message</li>
</ul>
<p>If you have any requests for others, please <a href="https://github.com/MarkEdmondson1234/googleCloudRunner/issues" class="external-link">raise
an issue on GitHub</a>.</p>
<p>Combine buildsteps with <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> e.g.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cr_build_yaml.html">cr_build_yaml</a></span><span class="op">(</span>
      steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/cr_buildstep.html">cr_buildstep</a></span><span class="op">(</span><span class="st">"ubuntu"</span>, <span class="st">"echo hello"</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/cr_buildstep_gcloud.html">cr_buildstep_gcloud</a></span><span class="op">(</span><span class="st">"gcloud"</span>,<span class="st">"version"</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/cr_buildstep_docker.html">cr_buildstep_docker</a></span><span class="op">(</span><span class="st">"my-image"</span>, tag<span class="op">=</span><span class="st">"dev"</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/cr_buildstep_secret.html">cr_buildstep_secret</a></span><span class="op">(</span><span class="st">"my_secret"</span>,<span class="st">"auth.json"</span><span class="op">)</span>,
        <span class="fu"><a href="../reference/cr_buildstep_r.html">cr_buildstep_r</a></span><span class="op">(</span><span class="st">"sessionInfo()"</span><span class="op">)</span><span class="op">)</span>,
      images <span class="op">=</span> <span class="st">"gcr.io/my-project/my-image"</span><span class="op">)</span></code></pre></div>
<p>The <code>cr_buildstep_*</code> functions are all calling
<code><a href="../reference/cr_buildstep.html">cr_buildstep()</a></code> with helpful defaults, for example these are
equivalent:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cr_buildstep_bash.html">cr_buildstep_bash</a></span><span class="op">(</span><span class="st">"echo hello world"</span><span class="op">)</span>
<span class="co">#[[1]]</span>
<span class="co">#==cloudRunnerBuildStep==</span>
<span class="co">#name: ubuntu</span>
<span class="co">#args:</span>
<span class="co">#- bash</span>
<span class="co">#- -c</span>
<span class="co">#- echo hello world</span>
<span class="fu"><a href="../reference/cr_buildstep.html">cr_buildstep</a></span><span class="op">(</span><span class="st">"ubuntu"</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bash"</span>, <span class="st">"-c"</span>, <span class="st">"echo hello world"</span><span class="op">)</span>, prefix <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="co">#[[1]]</span>
<span class="co">#==cloudRunnerBuildStep==</span>
<span class="co">#name: ubuntu</span>
<span class="co">#args:</span>
<span class="co">#- bash</span>
<span class="co">#- -c</span>
<span class="co">#- echo hello world</span></code></pre></div>
<p>To further aid deployments the <code>cr_deploy_*</code> functions
take some common tasks and use the buildsteps above, in some cases also
creating a build trigger or schedule.</p>
<p><img src="deploy_plot.png"></p>
</div>
<div class="section level2">
<h2 id="build-artifacts">Build Artifacts<a class="anchor" aria-label="anchor" href="#build-artifacts"></a>
</h2>
<p>You may have some useful files or data after your buildsteps run that
you want to use later. You can specify these files as
<strong>artifacts</strong> that will be uploaded to a Google Cloud
Storage bucket after the build finishes. A helper function
<code><a href="../reference/cr_build_artifacts.html">cr_build_artifacts()</a></code> will take your build object and
download the files to your local directory via
<code>googleCloudStorageR</code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r</span> <span class="op">&lt;-</span> <span class="st">"write.csv(mtcars,file = 'artifact.csv')"</span>
<span class="va">ba</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_yaml.html">cr_build_yaml</a></span><span class="op">(</span>
     steps <span class="op">=</span> <span class="fu"><a href="../reference/cr_buildstep_r.html">cr_buildstep_r</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>,
     artifacts <span class="op">=</span> <span class="fu"><a href="../reference/cr_build_yaml_artifact.html">cr_build_yaml_artifact</a></span><span class="op">(</span><span class="st">'artifact.csv'</span><span class="op">)</span>
     <span class="op">)</span>

<span class="va">build</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build.html">cr_build</a></span><span class="op">(</span><span class="va">ba</span><span class="op">)</span>
<span class="va">built</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_wait.html">cr_build_wait</a></span><span class="op">(</span><span class="va">build</span><span class="op">)</span>

<span class="fu"><a href="../reference/cr_build_artifacts.html">cr_build_artifacts</a></span><span class="op">(</span><span class="va">built</span><span class="op">)</span>
<span class="co"># 2019-12-22 12:36:10 -- Saved artifact.csv to artifact.csv (1.7 Kb)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"artifact.csv"</span><span class="op">)</span>
<span class="co">#                     X  mpg cyl  disp  hp drat    wt  qsec vs am gear carb</span>
<span class="co">#1            Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4</span>
<span class="co">#2        Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4</span>
<span class="co">#3           Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1</span>
<span class="co">#4       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1</span>
<span class="co"># ... etc ...</span></code></pre></div>
<p>Other common artifacts are Docker images that your build has created.
These are usually uploaded automatically to Container Registry, if say
you are using <code><a href="../reference/cr_deploy_docker.html">cr_deploy_docker()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="build-logs">Build Logs<a class="anchor" aria-label="anchor" href="#build-logs"></a>
</h2>
<p>You can view the logs of the build locally in R using
<code><a href="../reference/cr_build_logs.html">cr_build_logs()</a></code> if you pass it a build object, such as from
<code><a href="../reference/cr_build_wait.html">cr_build_wait()</a></code> (causes R to wait for build to finish) or
<code><a href="../reference/cr_build_status.html">cr_build_status()</a></code> (checks on build status)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_yaml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_yaml.html">cr_build_yaml</a></span><span class="op">(</span>steps <span class="op">=</span> <span class="fu"><a href="../reference/cr_buildstep.html">cr_buildstep</a></span><span class="op">(</span> <span class="st">"gcloud"</span>,<span class="st">"version"</span><span class="op">)</span><span class="op">)</span>
<span class="va">build</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_make.html">cr_build_make</a></span><span class="op">(</span><span class="va">s_yaml</span><span class="op">)</span>

<span class="va">built</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build.html">cr_build</a></span><span class="op">(</span><span class="va">build</span><span class="op">)</span>

<span class="va">the_build</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_wait.html">cr_build_wait</a></span><span class="op">(</span><span class="va">built</span><span class="op">)</span>

<span class="fu"><a href="../reference/cr_build_logs.html">cr_build_logs</a></span><span class="op">(</span><span class="va">the_build</span><span class="op">)</span>
<span class="co"># [1] "starting build \"6ce86e05-b0b1-4070-a849-05ec9020fd3b\""       </span>
<span class="co"># [2] ""                                                              </span>
<span class="co"># [3] "FETCHSOURCE"                                                   </span>
<span class="co"># [4] "BUILD"                                                         </span>
<span class="co"># [5] "Already have image (with digest): gcr.io/cloud-builders/gcloud"</span>
<span class="co"># [6] "Google Cloud SDK 325.0.0"                                      </span>
<span class="co"># [7] "alpha 2021.01.22"                                              </span>
<span class="co"># [8] "app-engine-go 1.9.71"        </span>
<span class="co"># ...</span></code></pre></div>
<div class="section level3">
<h3 id="rstudio-gadget---build-docker">RStudio Gadget - build Docker<a class="anchor" aria-label="anchor" href="#rstudio-gadget---build-docker"></a>
</h3>
<p>If you are using RStudio, installing the library will enable an <a href="https://rstudio.github.io/rstudioaddins/" class="external-link">RStudio Addin</a> that
can be called after you have setup the library as per the setup
page.</p>
<p>It includes a Shiny gadget that you can call via the Addin menu in
RStudio, via <code><a href="../reference/cr_deploy_gadget.html">googleCloudRunner::cr_deploy_gadget()</a></code> or
assigned to a hotkey (I use CTRL+SHIFT+D).</p>
<p>This sets up a Shiny UI to help smooth out deployments as
pictured:</p>
<p><img src="gadget_docker.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="r-buildsteps">R buildsteps<a class="anchor" aria-label="anchor" href="#r-buildsteps"></a>
</h2>
<p>Focusing on one buildstep in particular, since this is an R package -
you can send in R code into a build trigger using
<code><a href="../reference/cr_buildstep_r.html">cr_buildstep_r()</a></code>.</p>
<p>It accepts both inline R code or a file location. This R code is
executed in the R environment as specified in argument <code>name</code>
- they default to the R images provided by Rocker <a href="https://www.rocker-project.org/" class="external-link">rocker-project.org</a>.</p>
<p>If you want to build your own images (in perhaps another Cloud Build
using <code><a href="../reference/cr_deploy_docker.html">cr_deploy_docker()</a></code>) you can use your own R images
with custom R packages and resources.</p>
<p>Some useful R images have been made you could use or refer to their
Dockerfiles for:</p>
<ul>
<li>
<code>gcr.io/gcer-public/packagetools</code> - installs: devtools
covr rhub pkgdown goodpractice httr plumber rmarkdown</li>
<li>
<code>gcr.io/gcer-public/render_rmd</code> - installs: pkgdown
rmarkdown flexdashboard blogdown bookdown</li>
<li>
<code>gcr.io/gcer-public/googlecloudrunner</code> - installs:
containerit, googleCloudStorageR, plumber, googleCloudRunner</li>
</ul>
<p>The R code can be created within the Build at build time, or you can
refer to an existing R script within the Source.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create an R buildstep inline</span>
<span class="fu"><a href="../reference/cr_buildstep_r.html">cr_buildstep_r</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"paste('1+1=', 1+1)"</span>, <span class="st">"sessionInfo()"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># create an R buildstep from a local file</span>
<span class="fu"><a href="../reference/cr_buildstep_r.html">cr_buildstep_r</a></span><span class="op">(</span><span class="st">"my-r-file.R"</span><span class="op">)</span>

<span class="co"># create an R buildstep from a file within the source of the Build</span>
<span class="fu"><a href="../reference/cr_buildstep_r.html">cr_buildstep_r</a></span><span class="op">(</span><span class="st">"inst/schedule/schedule.R"</span>, r_source <span class="op">=</span> <span class="st">"runtime"</span><span class="op">)</span>

<span class="co"># use a different Rocker image e.g. rocker/verse</span>
<span class="fu"><a href="../reference/cr_buildstep_r.html">cr_buildstep_r</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"library(dplyr)"</span>, <span class="st">"mtcars %&gt;% select(mpg)"</span>, <span class="st">"sessionInfo"</span><span class="op">)</span>,
                name <span class="op">=</span> <span class="st">"verse"</span><span class="op">)</span>

<span class="co"># use your own R image with custom R</span>
<span class="va">my_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"devtools::install()"</span>, <span class="st">"pkgdown::build_site()"</span><span class="op">)</span>
<span class="va">br</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/cr_buildstep_r.html">cr_buildstep_r</a></span><span class="op">(</span><span class="va">my_r</span>, name<span class="op">=</span> <span class="st">"gcr.io/gcer-public/packagetools:latest"</span><span class="op">)</span>

<span class="co"># send it for building</span>
<span class="fu"><a href="../reference/cr_build.html">cr_build</a></span><span class="op">(</span><span class="fu"><a href="../reference/cr_build_yaml.html">cr_build_yaml</a></span><span class="op">(</span>steps<span class="op">=</span><span class="va">br</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="build-triggers">Build Triggers<a class="anchor" aria-label="anchor" href="#build-triggers"></a>
</h2>
<p>Once you have build steps and possibly a source created, you can
either set these up to run on a schedule via <code><a href="../reference/cr_schedule.html">cr_schedule()</a></code>
or you can use triggers that will run upon certain events.</p>
<div class="section level3">
<h3 id="setting-up-build-triggers-in-the-web-ui">Setting up Build Triggers in the Web UI<a class="anchor" aria-label="anchor" href="#setting-up-build-triggers-in-the-web-ui"></a>
</h3>
<p>The quickest way to get going is to use the web UI for Build Triggers
(<code>https://console.cloud.google.com/cloud-build/triggers</code>)</p>
<ol style="list-style-type: decimal">
<li>Link your repo (GitHub, Bitbucket or Cloud Repositories) to
Google</li>
<li>Create your Cloud Build using <code><a href="../reference/cr_build_yaml.html">cr_build_yaml()</a></code> etc.</li>
<li>Write out to a <code>cloudbuild.yml</code> file in your repository
(by default the root directory is checked)</li>
<li>Setup the Build Trigger in the Web UI
(<code>https://console.cloud.google.com/cloud-build/triggers</code>)</li>
<li>Make a git commit and check the Cloud Build has run in the history
(<code>https://console.cloud.google.com/cloud-build/builds</code>)</li>
<li>Modify the <code>cloudbuild.yml</code> file as you need, recommit to
trigger a new build.</li>
</ol>
<p>Learn how to set them up at this Google article on <a href="https://cloud.google.com/cloud-build/docs/running-builds/create-manage-triggers" class="external-link">creating
and managing build triggers</a>.</p>
<p>From there you get the option of connecting a repository either by
mirroring it from GitHub/Bitbucket or using Cloud Source
Repositories.</p>
<p>You can setup either Docker builds by just providing the location of
the <code>Dockerfile</code>, or have more control by providing a
<code>cloudbuild.yml</code> - by default these are looked for in the
root directory.</p>
<p>Here are some example for this package’s GitHub repo:</p>
<p><img src="buildtrigger_screen.png"></p>
<ul>
<li>The “do package checks” performs authenticated tests against the
package</li>
<li>The “git auth and push pkgdown website” rebuilds the website each
commit to master branch.</li>
<li>“Build a dockerfile for package builds” builds the
<code>gcr.io/gcer-public/packagetools</code> image</li>
<li>“pushGoogleCloudRunnerToGcerPublic” builds the
<code>gcr.io/gcer-public/googlecloudrunner</code> image</li>
</ul>
<p><img src="buildtrigger_example.png"></p>
</div>
<div class="section level3">
<h3 id="build-triggers-via-code">Build Triggers via code<a class="anchor" aria-label="anchor" href="#build-triggers-via-code"></a>
</h3>
<p>Once you know how to make Build Triggers in the Web UI, you may want
to move into doing them within R. This lets you scale quickly
applications and are using in some of the <code>cr_deploy_*()</code>
functions such as <code><a href="../reference/cr_deploy_docker_trigger.html">cr_deploy_docker_trigger()</a></code>.</p>
<p>Build Triggers can be made via R code using the
<code><a href="../reference/cr_buildtrigger.html">cr_buildtrigger()</a></code> function.</p>
<p>Build Triggers can execute on some useful triggers:</p>
<ul>
<li>GitHub commits and pull requests</li>
<li>PubSub triggers such as when a file hits Cloud Storage</li>
<li>Webhook triggers responding to 3rd party applications</li>
</ul>
<p>The example below shows how to set up some of the builds used in the
examples above:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get an existing cloudbuild.yaml file</span>
<span class="va">cloudbuild</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cloudbuild/cloudbuild.yaml"</span>,
                            package <span class="op">=</span> <span class="st">"googleCloudRunner"</span><span class="op">)</span>
                            
<span class="co"># import the build into R</span>
<span class="va">bb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_make.html">cr_build_make</a></span><span class="op">(</span><span class="va">cloudbuild</span>, projectId <span class="op">=</span> <span class="st">"test-project"</span><span class="op">)</span>

<span class="co"># specify the GitHub repo the trigger will react to</span>
<span class="va">github</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_buildtrigger_repo.html">cr_buildtrigger_repo</a></span><span class="op">(</span><span class="st">"MarkEdmondson1234/googleCloudRunner"</span>, branch <span class="op">=</span> <span class="st">"master"</span><span class="op">)</span>

<span class="co"># create the build trigger</span>
<span class="fu"><a href="../reference/cr_buildtrigger.html">cr_buildtrigger</a></span><span class="op">(</span><span class="va">bb</span>, name <span class="op">=</span> <span class="st">"trig1"</span>, trigger <span class="op">=</span> <span class="va">github</span><span class="op">)</span></code></pre></div>
<p>This build trigger will then build upon each git commit.</p>
<p>Build substitutions can also be configured by them into the
<code>substitutions</code> argument:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># creates a trigger with named substitutions</span>
<span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>`$_MYVAR` <span class="op">=</span> <span class="st">"TEST1"</span>, `$_GITHUB` <span class="op">=</span> <span class="st">"MarkEdmondson1234/googleCloudRunner"</span><span class="op">)</span>

<span class="co"># a buildtrigger with parametised substitutions</span>
<span class="fu"><a href="../reference/cr_buildtrigger.html">cr_buildtrigger</a></span><span class="op">(</span><span class="st">"trig2"</span>, trigger <span class="op">=</span> <span class="va">github</span>, build <span class="op">=</span> <span class="va">bb</span>, substitutions <span class="op">=</span> <span class="va">ss</span><span class="op">)</span></code></pre></div>
<p>The above examples will create the build step in-line within the
trigger, but you can also specify cloudbuild.yaml files by specifying
the path to where in the repository the build file will be:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create a trigger that will build from the file in the repo</span>
<span class="fu"><a href="../reference/cr_buildtrigger.html">cr_buildtrigger</a></span><span class="op">(</span><span class="st">"cloudbuild.yaml"</span>, name <span class="op">=</span> <span class="st">"trig3"</span>, trigger <span class="op">=</span> <span class="va">github</span><span class="op">)</span></code></pre></div>
<p>This way you can commit changes to the cloudbuild.yaml file, and they
will be reflected in the Build Trigger.</p>
</div>
<div class="section level3">
<h3 id="connecting-to-github">Connecting to GitHub<a class="anchor" aria-label="anchor" href="#connecting-to-github"></a>
</h3>
<p>You can connect via the <a href="https://cloud.google.com/source-repositories/docs/mirroring-a-github-repository" class="external-link">Source
Repository mirroring service</a> or via the <a href="https://github.com/marketplace/google-cloud-build" class="external-link">Google Cloud
Build GitHub app</a> - see the <a href="https://code.markedmondson.me/googleCloudRunner/articles/git.html">git
setup page</a> for more details.</p>
</div>
<div class="section level3">
<h3 id="combining-buildsteps-from-triggers-with-other-builds">Combining buildsteps from triggers with other builds<a class="anchor" aria-label="anchor" href="#combining-buildsteps-from-triggers-with-other-builds"></a>
</h3>
<p>It may be you want to combine build steps from across buildtriggers.
For example, you have a Docker build triggers and want to add some steps
that use that Docker image after its been built.</p>
<p>You can extract the buildsteps from deployed buildtriggers to combine
them and avoid having two builds.</p>
<p>For example, say you have deployed a Dockerfile trigger:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">repo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_buildtrigger_repo.html">cr_buildtrigger_repo</a></span><span class="op">(</span><span class="st">"your-github/your-repo"</span><span class="op">)</span>

<span class="co"># first time - by default will be called "docker-{image}"</span>
<span class="fu"><a href="../reference/cr_deploy_docker_trigger.html">cr_deploy_docker_trigger</a></span><span class="op">(</span><span class="va">repo</span>, image <span class="op">=</span> <span class="st">"my-build"</span><span class="op">)</span></code></pre></div>
<p>If you want to extract the docker buildsteps you can find it in
<code>dock_build$build$steps</code> below:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get the buildtrigger details</span>
<span class="va">dock_build</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_buildtrigger_get.html">cr_buildtrigger_get</a></span><span class="op">(</span><span class="st">"docker-my-build"</span><span class="op">)</span>

<span class="co"># contains the buildsteps from the deployment</span>
<span class="va">dock_build</span><span class="op">$</span><span class="va">build</span><span class="op">$</span><span class="va">steps</span></code></pre></div>
<p>You can then combine those buildsteps in the usual way with other
buildsteps. The example below assumes you’ve made an R docker image with
some of your custom dependencies that you then want to immediately run
your R code within:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># uses the docker image previously created</span>
<span class="va">my_r_step</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_buildstep_r.html">cr_buildstep_r</a></span><span class="op">(</span>r <span class="op">=</span> <span class="st">"my_r_code.R"</span>, name <span class="op">=</span> <span class="st">"docker-my-build"</span><span class="op">)</span>

<span class="co"># combine the buildsteps</span>
<span class="va">new_buildsteps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dock_build</span><span class="op">$</span><span class="va">build</span><span class="op">$</span><span class="va">steps</span>, <span class="va">my_r_step</span><span class="op">)</span>

<span class="co"># remake the build yaml</span>
<span class="va">yml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_yaml.html">cr_build_yaml</a></span><span class="op">(</span><span class="va">new_buildsteps</span><span class="op">)</span></code></pre></div>
<p>You can then reconfigure the build trigger with your new build yaml.
The below writes the yaml to a file to be read by the build trigger:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># write it out to the git repo we are in</span>
<span class="fu"><a href="../reference/cr_build_write.html">cr_build_write</a></span><span class="op">(</span><span class="va">yml</span>, <span class="st">"new_buildsteps.yml"</span><span class="op">)</span>

<span class="va">repo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_buildtrigger_repo.html">cr_buildtrigger_repo</a></span><span class="op">(</span><span class="st">"your-github/your-repo"</span><span class="op">)</span>

<span class="co"># overwrite the deployed build trigger to read the yml</span>
<span class="fu"><a href="../reference/cr_buildtrigger.html">cr_buildtrigger</a></span><span class="op">(</span>
  <span class="st">"new_buildsteps.yml"</span>,
  name <span class="op">=</span> <span class="st">"docker-my-build"</span>,
  trigger <span class="op">=</span> <span class="va">repo</span>,
  overwrite <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pubsub-triggered-cloud-builds">Pub/Sub Triggered Cloud Builds<a class="anchor" aria-label="anchor" href="#pubsub-triggered-cloud-builds"></a>
</h3>
<p>You can configure your build triggers to run from PubSub events.
These events are generated from a lot of different services around GCP,
such as when a file hits Cloud Storage, when certain events occur in
Cloud Logging, or when your budget alerts fire. Triggering a Cloud Build
can allow complex workflows responding to these events, including
picking up data from the PubSub message to parametrise your code via
Substitutions.</p>
<p>See the <a href="https://cloud.google.com/build/docs/automating-builds/create-pubsub-triggers" class="external-link">Creating
Pub/Sub triggers documentation</a> on how to do this in the WebUI and
gcloud.</p>
<p>Below is an example that uses <a href="https://CRAN.R-project.org/package=googlePubsubR" class="external-link"><code>googlePubSubR</code></a>
to create and send a message to PubSub, but any other service that
publishes to PubSub could be used.</p>
<p>For this example, the substitution variables will take its data from
the PubSub message content. It will look within the
<code>body.message.data.x</code> variable, where <code>x</code> is the
field sent in the pubsub message. See how to use these <a href="https://cloud.google.com/build/docs/configuring-builds/use-bash-and-bindings-in-substitutions" class="external-link">payload
bindings</a> in other ways at the Google documentation.</p>
<p>The cloud build yaml looks like:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">'alpine'</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">id</span><span class="kw">:</span><span class="at">  Hello Cloud Build</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"echo"</span><span class="kw">,</span><span class="at"> </span><span class="st">"Hello Cloud Build"</span><span class="kw">]</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">'rocker/r-base'</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">id</span><span class="kw">:</span><span class="at"> Hello R</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"Rscript"</span><span class="kw">,</span><span class="at"> </span><span class="st">"-e"</span><span class="kw">,</span><span class="at"> </span><span class="st">"paste0('From PubSub message field1:', '${_VAR1}')"</span><span class="kw">]</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">substitutions</span><span class="kw">:</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">_VAR1</span><span class="kw">:</span><span class="at"> </span><span class="st">'$(body.message.data.var1)'</span></span></code></pre></div>
<p>Note <code>_VAR1</code> which will be filled in with the
<code>var1</code> field coming from the PubSub message.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create build object</span>
<span class="va">cloudbuild</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"cloudbuild/cloudbuild_substitutions.yml"</span>,
                           package <span class="op">=</span> <span class="st">"googleCloudRunner"</span><span class="op">)</span>
<span class="va">the_build</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_make.html">cr_build_make</a></span><span class="op">(</span><span class="va">cloudbuild</span><span class="op">)</span>

<span class="va">the_build</span></code></pre></div>
<p>We then create the topic if it does not exist already:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create pub/sub topic if needed</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/andodet/googlePubsubR" class="external-link">googlePubsubR</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/googlePubsubR/man/pubsub_auth.html" class="external-link">pubsub_auth</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/googlePubsubR/man/topics_create.html" class="external-link">topics_create</a></span><span class="op">(</span><span class="st">"test-topic"</span><span class="op">)</span></code></pre></div>
<p>We now use the function <code><a href="../reference/cr_buildtrigger_pubsub.html">cr_buildtrigger_pubsub()</a></code> to
construct the trigger for the Cloud Build.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create build trigger that will work from pub/subscription</span>
<span class="va">pubsub_trigger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_buildtrigger_pubsub.html">cr_buildtrigger_pubsub</a></span><span class="op">(</span><span class="st">"test-topic"</span><span class="op">)</span>
<span class="fu"><a href="../reference/cr_buildtrigger.html">cr_buildtrigger</a></span><span class="op">(</span><span class="va">the_build</span>, name <span class="op">=</span> <span class="st">"pubsub-triggered-subs"</span>, trigger <span class="op">=</span> <span class="va">pubsub_trigger</span><span class="op">)</span>
<span class="co">#==CloudBuildTriggerResponse==</span>
<span class="co">#id:  b7fb7d8d-534d-4408-9e0c-154be6577a7f </span>
<span class="co">#name:  pubsub-triggered-subs </span>
<span class="co">#createdTime:  2021-11-26T21:39:23.714950565Z </span>
<span class="co">#==CloudBuildObject==</span>
<span class="co">#substitutions:</span>
<span class="co">#_VAR1 :  $(body.message.data.var1) </span>
<span class="co">#steps:</span>
<span class="co">#- name: alpine</span>
<span class="co">#  args:</span>
<span class="co">#  - echo</span>
<span class="co">#  - Hello Cloud Build</span>
<span class="co">#  id: Hello Cloud Build</span>
<span class="co">#- name: rocker/r-base</span>
<span class="co">#  args:</span>
<span class="co">#  - Rscript</span>
<span class="co">#  - -e</span>
<span class="co">#  - paste0('From PubSub message field1:', '${_VAR1}')</span>
<span class="co">#  id: Hello R</span></code></pre></div>
<p>The build trigger should now be deployed and available in your Cloud
Console.</p>
<p>We now simulate a PubSub message coming in with the <code>var1</code>
field filled. In real applications this PubSub trigger could come from
another system, Cloud Storage files, or other R scripts.</p>
<p>PubSub requires the message to be JSON and base64 encoded, so we use
<code><a href="https://arxiv.org/abs/1403.2805" class="external-link">library(jsonlite)</a></code> to do this and
<code><a href="https://github.com/andodet/googlePubsubR" class="external-link">library(googlePubsubR)</a></code> again to send the message:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># make base64 encoded json</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://arxiv.org/abs/1403.2805" class="external-link">jsonlite</a></span><span class="op">)</span>                     
<span class="va">message</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>var1 <span class="op">=</span> <span class="st">"hello mum"</span><span class="op">)</span><span class="op">)</span>
<span class="va">send_me</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/googlePubsubR/man/msg_encode.html" class="external-link">msg_encode</a></span><span class="op">(</span><span class="va">message</span><span class="op">)</span>

<span class="co"># send the message!</span>
<span class="fu"><a href="https://rdrr.io/pkg/googlePubsubR/man/topics_publish.html" class="external-link">topics_publish</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/googlePubsubR/man/PubsubMessage.html" class="external-link">PubsubMessage</a></span><span class="op">(</span><span class="va">send_me</span><span class="op">)</span>, <span class="st">"test-topic"</span><span class="op">)</span></code></pre></div>
<p>You should now see the Cloud Build start in your GCP console. You can
check the logs for the build after it has run to see if it worked:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># did it work?</span>
<span class="fu"><a href="../reference/cr_build_logs.html">cr_buildtrigger_logs</a></span><span class="op">(</span><span class="st">"pubsub-triggered-subs"</span><span class="op">)</span>

<span class="co"># yep!</span>
<span class="co">#...</span>
<span class="co">#[55] "Step #1 - \"Hello R\": Status: Downloaded newer image for rocker/r-base:latest"                                  </span>
<span class="co">#[56] "Step #1 - \"Hello R\": docker.io/rocker/r-base:latest"                                                           </span>
<span class="co">#[57] "Step #1 - \"Hello R\": [1] \"From PubSub message field1:[\\\"hello mum\\\"]\""                                   </span>
<span class="co">#[58] "Finished Step #1 - \"Hello R\""                                                                                  </span>
<span class="co">#[59] "PUSH"                                                                                                            </span>
<span class="co">#[60] "DONE"                                                                                                            </span></code></pre></div>
<p>See also <code><a href="../reference/cr_schedule.html">cr_schedule_pubsub()</a></code> which can use PubSub to
trigger scheduled builds. There is a guide using that within <a href="cloudscheduler.html">Cloud Scheduler to trigger Build Triggers via
Pubsub</a></p>
</div>
</div>
<div class="section level2">
<h2 id="targets-integration">Targets Integration<a class="anchor" aria-label="anchor" href="#targets-integration"></a>
</h2>
<p>The <a href="https://books.ropensci.org/targets/" class="external-link"><code>targets</code>
package</a> is a data pipeline toolkit for R which allows for
reproducible workflows without having to run the entire pipeline each
time. You can use it to create a graph of dependencies (directional
acyclic graphs, or DAG).</p>
<p>It is convenient to have these pipelines run in the cloud and in a
serverless manner in particular which <code>googleCloudRunner</code>
facilitates via the <code><a href="../reference/cr_build_targets.html">cr_build_targets()</a></code> function. Since the
pipeline can run in a Cloud Build, you do not need to have your local
machine on to run the pipeline. Cloud Build allows up to 24hrs timeout
values for the build, and costs are much lower than having a dedicated
computing cluster as you are only charged for the time the job is
running.</p>
<p>The integration looks through your existing <code>targets</code>
pipeline and creates the appropriate build steps for your build, reusing
the functions and target meta data in your local folder. By selecting to
run on Cloud Build, the local targets metadata folder is uploaded to
Cloud Storage, used to coordinate the different target pipeline steps
(<code>targets</code>) and then downloads the results back to your local
session.</p>
<p>The <code>cr_buildsteps_targets()</code> function is the base
buildstep you can use to create your workflows. Its more likely you will
use the <code><a href="../reference/cr_build_targets.html">cr_buildstep_targets_multi()</a></code> function which will
use these buildsteps to create your pipeline, including trying to
optimise the running time as much as possible by setting up concurrent
execution if possible.</p>
<p>In general the integration takes care of these steps:</p>
<ol style="list-style-type: decimal">
<li>Scan your system for the targets workflow</li>
<li>Creates a Cloud Build yaml that will execute the workflow</li>
<li>Uploads target metadata file (usually with
<code>_targets/meta</code>) to a Cloud Storage bucket</li>
<li>Executes the build, skipping any unnecessary steps and running
concurrently if possible</li>
<li>Uploads the results to Cloud Storage</li>
<li>Downloads from Cloud Storage to your local session if required</li>
</ol>
<p>You will need to create an R based Dockerfile to run the target
functions within, including at least targets and any other libraries you
need for your functions to execute. By default it will use
<code>gcr.io/gcer-public/targets</code> which is an image containing
<code>targets</code> only.</p>
<p>An overview of the targets functions is shown below:</p>
<p><img src="targets_plot.png"></p>
<div class="section level3">
<h3 id="targets-pipeline-example">Targets pipeline example<a class="anchor" aria-label="anchor" href="#targets-pipeline-example"></a>
</h3>
<p>The below example shows a minimal use case of running the pipeline
immediately:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">mtcars</span>, file <span class="op">=</span> <span class="st">"mtcars.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_script</span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_target</span><span class="op">(</span><span class="va">file1</span>,
      <span class="st">"mtcars.csv"</span>, format <span class="op">=</span> <span class="st">"file"</span><span class="op">)</span>,
    <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_target</span><span class="op">(</span><span class="va">input1</span>,
      <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">file1</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_target</span><span class="op">(</span><span class="va">result1</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">input1</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_target</span><span class="op">(</span><span class="va">result2</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">input1</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_target</span><span class="op">(</span><span class="va">result3</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">input1</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_target</span><span class="op">(</span><span class="va">result4</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">input1</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu">targets</span><span class="fu">::</span><span class="fu">tar_target</span><span class="op">(</span><span class="va">merge1</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">result1</span>, <span class="va">result2</span>, <span class="va">result3</span>, <span class="va">result4</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
 ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_targets.html">cr_buildstep_targets_multi</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># run it immediately in cloud</span>
<span class="fu"><a href="../reference/cr_build_targets.html">cr_build_targets</a></span><span class="op">(</span><span class="va">bs</span>, execute<span class="op">=</span><span class="st">"now"</span><span class="op">)</span></code></pre></div>
<p>The target pipeline is represented by this DAG (generated by
<code>targets::tar_visnetwork()</code>)</p>
<p><img src="demo_targets.png"></p>
<p>When you issue <code><a href="../reference/cr_build_targets.html">cr_buildstep_targets_multi()</a></code> the targets
DAG is analysed and used to create the buildsteps:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_build_targets.html">cr_buildstep_targets_multi</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#ℹ 2022-01-20 15:26:56 &gt; targets cloud location: gs://your-bucket/your-project</span>
<span class="co">#ℹ 2022-01-20 15:26:56 &gt; Resolving targets::tar_manifest()</span>
 
<span class="co">#── # Building DAG: ───────────────────────────────────────────────────────────</span>
<span class="co">#• [get previous _targets metadata] -&gt; [file1]</span>
<span class="co">#• [file1] -&gt; [input1]</span>
<span class="co">#• [input1] -&gt; [result1]</span>
<span class="co">#• [input1] -&gt; [result2]</span>
<span class="co">#• [input1] -&gt; [result3]</span>
<span class="co">#• [input1] -&gt; [result4]</span>
<span class="co">#• [result1, result2, result3, result4] -&gt; [merge1]</span>
<span class="co">#• [merge1] -&gt; [ Upload Artifacts ]</span></code></pre></div>
<p>The <code>[get previous _targets metadata]</code> buildstep is
boilerplate generated by <code><a href="../reference/cr_buildstep_targets.html">cr_buildstep_targets_setup()</a></code>,
whilst <code>[ Upload Artifacts ]</code> is the one generated by
<code><a href="../reference/cr_buildstep_targets.html">cr_buildstep_targets_teardown()</a></code>.</p>
<p>The DAG is created by populating the <code>id</code> and
<code>waitFor</code> arguments within a <code><a href="../reference/cr_buildstep.html">cr_buildstep()</a></code>.
These buildsteps could be used directly in <code><a href="../reference/cr_build.html">cr_build()</a></code> but
you would need to handle uploading the data sources etc. which is what
<code><a href="../reference/cr_build_targets.html">cr_build_targets()</a></code> helps with.</p>
<p>Passing these buildsteps into <code><a href="../reference/cr_build_targets.html">cr_build_targets()</a></code> allows
you to select <code>execute="now"</code> which will run the pipeline
immediately. <code>execute="trigger"</code> will only create the YAML
for you to use in constructing a buildstep.</p>
<p><code>cr_build_targets(bs, execute="now")</code> will start off a
build like the below example:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cr_build_targets</span>(bs, <span class="at">execute=</span><span class="st">"now"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>── <span class="co"># Uploading . to gs://your-buucket/.20220120152659.tar.gz ───────────────────────</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2022-01-20</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">27</span><span class="sc">:</span><span class="dv">00</span> <span class="sc">&gt;</span> Tarring files <span class="cf">in</span> tmpdir<span class="sc">:</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>• _pkgdown.yml</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>• _targets.R</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>• etc ...</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>ℹ Cloud Build started <span class="sc">-</span> logs<span class="sc">:</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="er">&lt;</span>https<span class="sc">:</span><span class="er">//</span>console.cloud.google.com<span class="sc">/</span>cloud<span class="sc">-</span>build<span class="sc">/</span>builds<span class="sc">/</span>17ce8d71<span class="sc">-</span>593c<span class="sc">-</span>44f0<span class="dv">-8990</span><span class="sc">-</span>9a3192016b0f<span class="sc">&gt;</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2022-01-20</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">28</span><span class="sc">:</span><span class="dv">42</span> <span class="sc">&gt;</span> targets cloud location<span class="sc">:</span> gs<span class="sc">:</span><span class="er">//</span>your<span class="sc">-</span>bucket<span class="sc">/</span><span class="er">/</span>your<span class="sc">-</span>local</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2022-01-20</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">28</span><span class="sc">:</span><span class="dv">42</span> <span class="sc">&gt;</span> Downloading to download_folder<span class="sc">:</span> <span class="er">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>buildtime.txt to _targets<span class="sc">/</span><span class="fu">buildtime.txt</span>  ( <span class="dv">29</span> bytes )</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>meta<span class="sc">/</span>meta to _targets<span class="sc">/</span>meta<span class="sc">/</span><span class="fu">meta</span>  ( <span class="dv">1</span> Kb )</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>meta<span class="sc">/</span>process to _targets<span class="sc">/</span>meta<span class="sc">/</span><span class="fu">process</span>  ( <span class="dv">56</span> bytes )</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>meta<span class="sc">/</span>progress to _targets<span class="sc">/</span>meta<span class="sc">/</span><span class="fu">progress</span>  ( <span class="dv">271</span> bytes )</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>objects<span class="sc">/</span>input1 to _targets<span class="sc">/</span>objects<span class="sc">/</span><span class="fu">input1</span>  ( <span class="dv">861</span> bytes )</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>objects<span class="sc">/</span>merge1 to _targets<span class="sc">/</span>objects<span class="sc">/</span><span class="fu">merge1</span>  ( <span class="dv">77</span> bytes )</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>objects<span class="sc">/</span>result1 to _targets<span class="sc">/</span>objects<span class="sc">/</span><span class="fu">result1</span>  ( <span class="dv">52</span> bytes )</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>objects<span class="sc">/</span>result2 to _targets<span class="sc">/</span>objects<span class="sc">/</span><span class="fu">result2</span>  ( <span class="dv">52</span> bytes )</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span><span class="er">/</span>_targets<span class="sc">/</span>objects<span class="sc">/</span>result3 to _targets<span class="sc">/</span>objects<span class="sc">/</span><span class="fu">result3</span>  ( <span class="dv">52</span> bytes )</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>✓ Saved <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets<span class="sc">/</span>objects<span class="sc">/</span>result4 to _targets<span class="sc">/</span>objects<span class="sc">/</span><span class="fu">result4</span>  ( <span class="dv">52</span> bytes )</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>── <span class="co"># Built targets on Cloud Build with status: SUCCESS ─────────────────────────</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2022-01-20</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">28</span><span class="sc">:</span><span class="dv">44</span> <span class="sc">&gt;</span> Build artifacts downloaded to <span class="sc">/</span>your<span class="sc">-</span>local<span class="sc">/</span>_targets</span></code></pre></div>
<p>Inspecting your local <code>_targets</code> metadata (via
<code>targets::tar_meta()</code> or otherwise) should confirm the steps
have been updated via the Cloud Build code.</p>
</div>
<div class="section level3">
<h3 id="scheduling-or-triggering-your-targets-pipeline">Scheduling or triggering your targets pipeline<a class="anchor" aria-label="anchor" href="#scheduling-or-triggering-your-targets-pipeline"></a>
</h3>
<p>As the targets are running within a Cloud Build, all the usual
methods of triggering a build are available via Build Triggers. This
includes executing in response to events such as a Cloud Storage bucket
being updated with a file, a GitHub commit, a PubSub event or a
scheduled PubSub call.</p>
<p>Since pipelines are normally waiting for Cloud Storage files or say
BigQuery table uploads, the new PubSub triggers for build Triggers are
particularly convenient, since they can trigger on pretty much any event
within GCP via <a href="https://cloud.google.com/logging/docs/export/configure_export_v2" class="external-link">Cloud
Logging sinks</a>.</p>
<p>The example below will use a GitHub source and trigger upon a
scheduled PubSub event.</p>
<div class="section level4">
<h4 id="creating-a-scheduled-targets-pipeline">Creating a scheduled targets pipeline<a class="anchor" aria-label="anchor" href="#creating-a-scheduled-targets-pipeline"></a>
</h4>
<p>The Cloud Build will be the same as the example above, only this time
we select <code>execute="trigger"</code></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cr_build_targets</span>(bs, <span class="at">execute=</span><span class="st">"trigger"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ℹ <span class="dv">2022-01-20</span> <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span><span class="sc">:</span><span class="dv">28</span> <span class="sc">&gt;</span> Writing to cloudbuild_targets.yaml</span></code></pre></div>
<p>The <code>cloudbuild_targets.yaml</code> file will sit in the same
GitHub repo as the target pipeline, and all shall be commit to
GitHub.</p>
<p>The PubSub topic can be an existing one but for this example we
create our own via <a href="https://CRAN.R-project.org/package=googlePubsubR" class="external-link"><code>googlePubsubR</code></a>
and schedule a hit to it every 24hrs at 0415.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/andodet/googlePubsubR" class="external-link">googlePubsubR</a></span><span class="op">)</span>
<span class="va">topic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/googlePubsubR/man/topics_create.html" class="external-link">topics_create</a></span><span class="op">(</span><span class="st">"target_pubsub_schedule"</span><span class="op">)</span>

<span class="va">schedule_me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_schedule.html">cr_schedule_pubsub</a></span><span class="op">(</span><span class="va">topic</span><span class="op">)</span>

<span class="fu"><a href="../reference/cr_schedule.html">cr_schedule</a></span><span class="op">(</span><span class="st">"target_pubsub_schedule"</span>, 
            schedule <span class="op">=</span> <span class="st">"15 4 * * *"</span>, 
            pubsubTarget <span class="op">=</span> <span class="va">schedule_me</span><span class="op">)</span></code></pre></div>
<p>Now the PubSub topic is being triggered on a schedule, we create a
Build Trigger that will respond to it.</p>
<p>The build trigger for a GitHub source is shown below - it uses a
parameter <code>sourceToBuild</code> to specify which git repo to build
upon:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># no regex allowed for sourceToBuild repo objects</span>
<span class="va">gh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_buildtrigger_repo.html">cr_buildtrigger_repo</a></span><span class="op">(</span><span class="st">"MarkEdmondson1234/googleCloudRunner"</span>, branch <span class="op">=</span> <span class="st">"master"</span><span class="op">)</span>

<span class="va">pubsub_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cr_buildtrigger_pubsub.html">cr_buildtrigger_pubsub</a></span><span class="op">(</span><span class="va">topic</span><span class="op">)</span>

<span class="fu"><a href="../reference/cr_buildtrigger.html">cr_buildtrigger</a></span><span class="op">(</span><span class="st">"cloudbuild_targets.yaml"</span>,
                name <span class="op">=</span> <span class="st">"targets-scheduled-demo"</span>,
                sourceToBuild <span class="op">=</span> <span class="va">gh</span>,
                trigger <span class="op">=</span> <span class="va">pubsub_sub</span><span class="op">)</span></code></pre></div>
<p>In summary the GCP resources you now have should be:</p>
<ol style="list-style-type: decimal">
<li>A PubSub topic via
<code>googlePubsubR::topics_get("target_pubsub_schedule")</code>
</li>
<li>A scheduler triggering that topic:</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cr_schedule_get</span>(<span class="st">"target_pubsub_schedule"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="sc">==</span>CloudScheduleJob<span class="sc">==</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>name<span class="sc">:</span>  projects<span class="sc">/</span>your<span class="sc">-</span>project<span class="sc">/</span>locations<span class="sc">/</span>europe<span class="sc">-</span>west1<span class="sc">/</span>jobs<span class="sc">/</span>target_pubsub_schedule </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>state<span class="sc">:</span>  ENABLED </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>pubsubTarget.topicName<span class="sc">:</span>  projects<span class="sc">/</span>your<span class="sc">-</span>project<span class="sc">/</span>topics<span class="sc">/</span>target_pubsub_schedule </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>pubsubTarget.data<span class="sc">:</span>  InByb2plY3RzL21hcmstZWRtb25kc29uLWdkZS90b3BpY3MvdGFyZ2V0X3B1YnN1Yl9zY2hlZHVsZSI<span class="ot">=</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pubsubTarget.data</span> (unencoded)<span class="sc">:</span>  <span class="st">"projects/your-project/topics/target_pubsub_schedule"</span> </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>userUpdateTime<span class="sc">:</span>  <span class="dv">2022-01</span><span class="sc">-</span>20T15<span class="sc">:</span><span class="dv">55</span><span class="sc">:</span>28Z </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>schedule<span class="sc">:</span>  <span class="dv">15</span> <span class="dv">4</span> <span class="sc">*</span> <span class="er">*</span> <span class="er">*</span> </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>scheduleTime<span class="sc">:</span> <span class="dv">2022-01</span><span class="sc">-</span>26T03<span class="sc">:</span><span class="dv">15</span><span class="sc">:</span><span class="fl">00.867249</span>Z </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>timezone<span class="sc">:</span>  Europe<span class="sc">/</span>Copenhagen</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>A build trigger triggered by the PubSub and showing the
sourceToBuild:</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cr_buildtrigger_get</span>(<span class="st">"targets-scheduled-demo"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="sc">==</span>CloudBuildTriggerResponse<span class="sc">==</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>id<span class="sc">:</span>  8c4f3447<span class="sc">-</span>b718<span class="dv">-4252</span><span class="sc">-</span>9b6a<span class="sc">-</span>45a504730de2 </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>name<span class="sc">:</span>  targets<span class="sc">-</span>scheduled<span class="sc">-</span>demo </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>createdTime<span class="sc">:</span>  <span class="dv">2022-01</span><span class="sc">-</span>20T21<span class="sc">:</span><span class="dv">32</span><span class="sc">:</span><span class="fl">00.603354443</span>Z </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>filename<span class="sc">:</span>  cloudbuild_targets.yaml </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>sourceToBuild.uri<span class="sc">:</span>  https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>MarkEdmondson1234<span class="sc">/</span>googleCloudRunner </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>sourceToBuild.ref<span class="sc">:</span>  refs<span class="sc">/</span>heads<span class="sc">/</span>master </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>sourceToBuild.repoType<span class="sc">:</span> GITHUB </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="sc">==</span>CloudBuildTriggerPubSubConfig<span class="sc">==</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>topic<span class="sc">:</span>  projects<span class="sc">/</span>your<span class="sc">-</span>project<span class="sc">/</span>topics<span class="sc">/</span>target_pubsub_schedule </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>subscription<span class="sc">:</span>  projects<span class="sc">/</span><span class="dv">123434564</span><span class="sc">/</span>subscriptions<span class="sc">/</span>gcb<span class="sc">-</span>targets<span class="sc">-</span>scheduled<span class="sc">-</span>demo </span></code></pre></div>
<p>You can modify each of these moving parts independently, for example
swapping the pubsub for a Cloud Storage event that triggers many builds,
or parametrising your PubSub trigger to trigger different behaviour. It
is recommend for the first attempt to keep it simple with a one-to-one
relationship between builds, pubsub topics and triggers.</p>
<ol start="4" style="list-style-type: decimal">
<li>You should see successful builds and can check the status of the
last build via <code><a href="../reference/cr_build_logs.html">cr_buildtrigger_logs()</a></code> which downloads the
last build of the given build trigger:</li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cr_buildtrigger_logs</span>(<span class="st">"targets-scheduled-demo"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"starting build </span><span class="sc">\"</span><span class="st">b3a2c366-3280-4ecb-a7c3-9916233e2dc7</span><span class="sc">\"</span><span class="st">"</span>                                                                                 </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>] <span class="st">""</span>                                     </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">96</span>] <span class="st">"Step #1 - </span><span class="sc">\"</span><span class="st">file1</span><span class="sc">\"</span><span class="st">: gcr.io/gcer-public/targets:latest"</span>                                                                                  </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">97</span>] <span class="st">"Step #1 - </span><span class="sc">\"</span><span class="st">file1</span><span class="sc">\"</span><span class="st">: ✔ skip target file1"</span>                                                                                                </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">98</span>] <span class="st">"Step #1 - </span><span class="sc">\"</span><span class="st">file1</span><span class="sc">\"</span><span class="st">: ✔ skip pipeline"</span>                                                                                                    </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">99</span>] <span class="st">"Finished Step #1 - </span><span class="sc">\"</span><span class="st">file1</span><span class="sc">\"</span><span class="st">"</span>                                                                                                            </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">100</span>] <span class="st">"Starting Step #2 - </span><span class="sc">\"</span><span class="st">input1</span><span class="sc">\"</span><span class="st">"</span>                                                                                                           </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">101</span>] <span class="st">"Step #2 - </span><span class="sc">\"</span><span class="st">input1</span><span class="sc">\"</span><span class="st">: Already have image (with digest): gcr.io/gcer-public/targets"</span>                                                      </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">102</span>] <span class="st">"Step #2 - </span><span class="sc">\"</span><span class="st">input1</span><span class="sc">\"</span><span class="st">: ✔ skip target file1"</span>                                                                                               </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">103</span>] <span class="st">"Step #2 - </span><span class="sc">\"</span><span class="st">input1</span><span class="sc">\"</span><span class="st">: ✔ skip target input1"</span>                                                                                              </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">104</span>] <span class="st">"Step #2 - </span><span class="sc">\"</span><span class="st">input1</span><span class="sc">\"</span><span class="st">: ✔ skip pipeline"</span>                                                                                                   </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">105</span>] <span class="st">"Finished Step #2 - </span><span class="sc">\"</span><span class="st">input1</span><span class="sc">\"</span><span class="st">"</span>                                                                                                           </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">106</span>] <span class="st">"Starting Step #3 - </span><span class="sc">\"</span><span class="st">result1</span><span class="sc">\"</span><span class="st">"</span>                                                                                                          </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">107</span>] <span class="st">"Starting Step #6 - </span><span class="sc">\"</span><span class="st">result4</span><span class="sc">\"</span><span class="st">"</span>                                                                                                          </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">108</span>] <span class="st">"Starting Step #5 - </span><span class="sc">\"</span><span class="st">result3</span><span class="sc">\"</span><span class="st">"</span>                                                                                                          </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>[<span class="dv">109</span>] <span class="st">"Starting Step #4 - </span><span class="sc">\"</span><span class="st">result2</span><span class="sc">\"</span><span class="st">"</span>                                                                                                          </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>[<span class="dv">110</span>] <span class="st">"Step #4 - </span><span class="sc">\"</span><span class="st">result2</span><span class="sc">\"</span><span class="st">: Already have image (with digest): gcr.io/gcer-public/targets"</span>                                                     </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">111</span>] <span class="st">"Step #6 - </span><span class="sc">\"</span><span class="st">result4</span><span class="sc">\"</span><span class="st">: Already have image (with digest): gcr.io/gcer-public/targets"</span>                                                     </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>[<span class="dv">112</span>] <span class="st">"Step #5 - </span><span class="sc">\"</span><span class="st">result3</span><span class="sc">\"</span><span class="st">: Already have image (with digest): gcr.io/gcer-public/targets"</span>                                                     </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">113</span>] <span class="st">"Step #3 - </span><span class="sc">\"</span><span class="st">result1</span><span class="sc">\"</span><span class="st">: Already have image (with digest): gcr.io/gcer-public/targets"</span>                                                     </span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>[<span class="dv">114</span>] <span class="st">"Step #5 - </span><span class="sc">\"</span><span class="st">result3</span><span class="sc">\"</span><span class="st">: ✔ skip target file1"</span>                                                                                              </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>[<span class="dv">115</span>] <span class="st">"Step #5 - </span><span class="sc">\"</span><span class="st">result3</span><span class="sc">\"</span><span class="st">: ✔ skip target input1"</span>                                                                                             </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>[<span class="dv">116</span>] <span class="st">"Step #5 - </span><span class="sc">\"</span><span class="st">result3</span><span class="sc">\"</span><span class="st">: ✔ skip target result3"</span>                                                                                            </span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>[<span class="dv">117</span>] <span class="st">"Step #5 - </span><span class="sc">\"</span><span class="st">result3</span><span class="sc">\"</span><span class="st">: ✔ skip pipeline"</span>                                                                                                  </span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>[<span class="dv">118</span>] <span class="st">"Finished Step #5 - </span><span class="sc">\"</span><span class="st">result3</span><span class="sc">\"</span><span class="st">"</span>                                                                                                          </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>[<span class="dv">119</span>] <span class="st">"Step #3 - </span><span class="sc">\"</span><span class="st">result1</span><span class="sc">\"</span><span class="st">: ✔ skip target file1"</span>                                                                                              </span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>[<span class="dv">120</span>] <span class="st">"Step #3 - </span><span class="sc">\"</span><span class="st">result1</span><span class="sc">\"</span><span class="st">: ✔ skip target input1"</span>                                                                                             </span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>[<span class="dv">121</span>] <span class="st">"Step #3 - </span><span class="sc">\"</span><span class="st">result1</span><span class="sc">\"</span><span class="st">: ✔ skip target result1"</span>                                                                                            </span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>[<span class="dv">122</span>] <span class="st">"Step #3 - </span><span class="sc">\"</span><span class="st">result1</span><span class="sc">\"</span><span class="st">: ✔ skip pipeline"</span>                                                                                                  </span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>[<span class="dv">123</span>] <span class="st">"Step #4 - </span><span class="sc">\"</span><span class="st">result2</span><span class="sc">\"</span><span class="st">: ✔ skip target file1"</span>                                                                                              </span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>[<span class="dv">124</span>] <span class="st">"Step #4 - </span><span class="sc">\"</span><span class="st">result2</span><span class="sc">\"</span><span class="st">: ✔ skip target input1"</span>                                                                                             </span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>[<span class="dv">125</span>] <span class="st">"Step #4 - </span><span class="sc">\"</span><span class="st">result2</span><span class="sc">\"</span><span class="st">: ✔ skip target result2"</span>                                                                                            </span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>[<span class="dv">126</span>] <span class="st">"Step #4 - </span><span class="sc">\"</span><span class="st">result2</span><span class="sc">\"</span><span class="st">: ✔ skip pipeline"</span>                                                                                                  </span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>[<span class="dv">127</span>] <span class="st">"Finished Step #3 - </span><span class="sc">\"</span><span class="st">result1</span><span class="sc">\"</span><span class="st">"</span>                                                                                                          </span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>[<span class="dv">128</span>] <span class="st">"Step #6 - </span><span class="sc">\"</span><span class="st">result4</span><span class="sc">\"</span><span class="st">: ✔ skip target file1"</span>                                                                                              </span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>[<span class="dv">129</span>] <span class="st">"Step #6 - </span><span class="sc">\"</span><span class="st">result4</span><span class="sc">\"</span><span class="st">: ✔ skip target input1"</span>                                                                                             </span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>[<span class="dv">130</span>] <span class="st">"Step #6 - </span><span class="sc">\"</span><span class="st">result4</span><span class="sc">\"</span><span class="st">: ✔ skip target result4"</span>                                                                                            </span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>[<span class="dv">131</span>] <span class="st">"Step #6 - </span><span class="sc">\"</span><span class="st">result4</span><span class="sc">\"</span><span class="st">: ✔ skip pipeline"</span>                                                                                                  </span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>[<span class="dv">132</span>] <span class="st">"Finished Step #4 - </span><span class="sc">\"</span><span class="st">result2</span><span class="sc">\"</span><span class="st">"</span>                                                                                                          </span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>[<span class="dv">133</span>] <span class="st">"Finished Step #6 - </span><span class="sc">\"</span><span class="st">result4</span><span class="sc">\"</span><span class="st">"</span>                                                                                                          </span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>[<span class="dv">134</span>] <span class="st">"Starting Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">"</span>                                                                                                           </span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>[<span class="dv">135</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: Already have image (with digest): gcr.io/gcer-public/targets"</span>                                                      </span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>[<span class="dv">136</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: ✔ skip target file1"</span>                                                                                               </span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>[<span class="dv">137</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: ✔ skip target input1"</span>                                                                                              </span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>[<span class="dv">138</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: ✔ skip target result1"</span>                                                                                             </span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>[<span class="dv">139</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: ✔ skip target result2"</span>                                                                                             </span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>[<span class="dv">140</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: ✔ skip target result3"</span>                                                                                             </span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>[<span class="dv">141</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: ✔ skip target result4"</span>                                                                                             </span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>[<span class="dv">142</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: ✔ skip target merge1"</span>                                                                                              </span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>[<span class="dv">143</span>] <span class="st">"Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">: ✔ skip pipeline"</span>                                                                                                   </span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>[<span class="dv">144</span>] <span class="st">"Finished Step #7 - </span><span class="sc">\"</span><span class="st">merge1</span><span class="sc">\"</span><span class="st">"</span>                                                                                                           </span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>[<span class="dv">145</span>] <span class="st">"Starting Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">"</span>                                                                                                 </span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>[<span class="dv">146</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: Already have image (with digest): gcr.io/google.com/cloudsdktool/cloud-sdk:alpine"</span>                       </span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>[<span class="dv">147</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: Copying file://buildtime.txt [Content-Type=text/plain]..."</span>                                               </span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>[<span class="dv">148</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: / [0 files][    0.0 B/   29.0 B]                                                "</span>                        </span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>[<span class="dv">149</span>] <span class="st">"/ [1 files][   29.0 B/   29.0 B]                                                "</span>                                                        </span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>[<span class="dv">150</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: Operation completed over 1 objects/29.0 B.                                       "</span>                       </span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>[<span class="dv">151</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: Copying file:///workspace/_targets/buildtime.txt [Content-Type=text/plain]..."</span>                           </span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>[<span class="dv">152</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: / [0 files][    0.0 B/   29.0 B]                                                "</span>                        </span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>[<span class="dv">153</span>] <span class="st">"Copying file:///workspace/_targets/meta/progress [Content-Type=application/octet-stream]..."</span>                                             </span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>[<span class="dv">154</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: Copying file:///workspace/_targets/meta/meta [Content-Type=application/octet-stream]..."</span>                 </span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>[<span class="dv">155</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: / [0 files][    0.0 B/  273.0 B]                                                "</span>                        </span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>[<span class="dv">156</span>] <span class="st">"/ [0 files][    0.0 B/  1.3 KiB]                                                "</span>                                                        </span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>[<span class="dv">157</span>] <span class="st">"Copying file:///workspace/_targets/objects/result3 [Content-Type=application/octet-stream]..."</span>                                           </span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>[<span class="dv">158</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: Copying file:///workspace/_targets/meta/process [Content-Type=application/octet-stream]..."</span>              </span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>[<span class="dv">159</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: Copying file:///workspace/_targets/objects/result4 [Content-Type=application/octet-stream]..."</span>           </span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>[<span class="dv">160</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: Copying file:///workspace/_targets/objects/input1 [Content-Type=application/octet-stream]..."</span>            </span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>[<span class="dv">161</span>] <span class="st">"Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">: / [0 files][    0.0 B/  1.4 KiB]                                                "</span>                        </span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>[<span class="dv">200</span>] <span class="st">"Finished Step #8 - </span><span class="sc">\"</span><span class="st">Upload Artifacts</span><span class="sc">\"</span><span class="st">"</span>                                                                                                 </span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>[<span class="dv">201</span>] <span class="st">"PUSH"</span>                                                                                                                                    </span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>[<span class="dv">202</span>] <span class="st">"DONE"</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Mark Edmondson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
